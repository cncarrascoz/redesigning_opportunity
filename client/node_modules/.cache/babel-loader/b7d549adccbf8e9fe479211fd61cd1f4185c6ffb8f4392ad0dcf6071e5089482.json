{"ast":null,"code":"var _jsxFileName = \"/Users/mahiarahman/Documents/Harvard/classes/cs1060/hw6/redesigning_opportunity/client/src/components/OpportunityMap.js\",\n  _s = $RefreshSig$();\nimport React, { useRef, useEffect, useState } from 'react';\nimport mapboxgl from 'mapbox-gl';\nimport 'mapbox-gl/dist/mapbox-gl.css';\nimport { Box, Typography } from '@mui/material';\n\n// Set the Mapbox access token\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nmapboxgl.accessToken = 'pk.eyJ1IjoibWFoaWFyIiwiYSI6ImNtNDY1YnlwdDB2Z2IybHEwd2w3MHJvb3cifQ.wJqnzFFTwLFwYhiPG3SWJA';\n\n// For debugging\nconsole.log('Mapbox token set:', mapboxgl.accessToken);\nconsole.log('Mapbox version:', mapboxgl.version);\nconst OpportunityMap = ({\n  neighborhoods\n}) => {\n  _s();\n  const mapContainerRef = useRef(null);\n  const mapRef = useRef(null);\n  const [mapError, setMapError] = useState(null);\n\n  // Initialize map when component mounts\n  useEffect(() => {\n    console.log('Initializing map');\n\n    // Check if map is already initialized\n    if (mapRef.current) return;\n    try {\n      console.log('Creating map with container:', mapContainerRef.current);\n      const map = new mapboxgl.Map({\n        container: mapContainerRef.current,\n        style: 'mapbox://styles/mapbox/streets-v12',\n        center: [-73.97, 40.75],\n        // NYC coordinates\n        zoom: 10,\n        attributionControl: true\n      });\n      console.log('Map initialized successfully');\n      mapRef.current = map;\n\n      // Add navigation control\n      map.addControl(new mapboxgl.NavigationControl(), 'top-right');\n\n      // Add a simple marker for testing\n      new mapboxgl.Marker().setLngLat([-73.97, 40.75]).addTo(map);\n\n      // Clean up on unmount\n      return () => map.remove();\n    } catch (error) {\n      console.error('Error initializing map:', error);\n      setMapError(`Failed to initialize map: ${error.message}`);\n    }\n  }, []);\n\n  // Add neighborhoods data when it's available\n  useEffect(() => {\n    if (!mapRef.current || !neighborhoods) return;\n    const map = mapRef.current;\n    try {\n      // Wait for the map to be loaded\n      if (!map.isStyleLoaded()) {\n        map.once('style.load', () => {\n          addNeighborhoodsToMap(map, neighborhoods);\n        });\n      } else {\n        addNeighborhoodsToMap(map, neighborhoods);\n      }\n    } catch (error) {\n      console.error('Error adding neighborhoods:', error);\n      setMapError(`Failed to add neighborhoods: ${error.message}`);\n    }\n  }, [neighborhoods]);\n\n  // Helper function to add neighborhoods to the map\n  const addNeighborhoodsToMap = (map, data) => {\n    console.log('Adding neighborhoods to map');\n\n    // Remove existing source and layers if they exist\n    if (map.getSource('neighborhoods')) {\n      map.removeLayer('neighborhood-borders');\n      map.removeLayer('neighborhood-fills');\n      map.removeSource('neighborhoods');\n    }\n\n    // Add the neighborhoods data as a source\n    map.addSource('neighborhoods', {\n      type: 'geojson',\n      data: data\n    });\n\n    // Add a layer for the neighborhood polygons\n    map.addLayer({\n      id: 'neighborhood-fills',\n      type: 'fill',\n      source: 'neighborhoods',\n      layout: {},\n      paint: {\n        'fill-color': ['interpolate', ['linear'], ['get', 'opportunityScore'], 0, '#f7fbff', 2, '#d0e1f2', 4, '#94c4df', 6, '#4a98c9', 8, '#1764ab', 10, '#08306b'],\n        'fill-opacity': 0.7\n      }\n    });\n\n    // Add a layer for the neighborhood borders\n    map.addLayer({\n      id: 'neighborhood-borders',\n      type: 'line',\n      source: 'neighborhoods',\n      layout: {},\n      paint: {\n        'line-color': '#000',\n        'line-width': 1\n      }\n    });\n\n    // Add a popup on hover\n    const popup = new mapboxgl.Popup({\n      closeButton: false,\n      closeOnClick: false\n    });\n    map.on('mouseenter', 'neighborhood-fills', e => {\n      map.getCanvas().style.cursor = 'pointer';\n      const properties = e.features[0].properties;\n      const coordinates = e.lngLat;\n      const html = `\n        <strong>${properties.name}</strong><br/>\n        Opportunity Score: ${properties.opportunityScore}<br/>\n        School Quality: ${properties.schoolQuality}<br/>\n        ${properties.description}\n      `;\n      popup.setLngLat(coordinates).setHTML(html).addTo(map);\n    });\n    map.on('mouseleave', 'neighborhood-fills', () => {\n      map.getCanvas().style.cursor = '';\n      popup.remove();\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(Box, {\n    sx: {\n      width: '100%',\n      height: '100%',\n      position: 'relative'\n    },\n    children: mapError ? /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        p: 3,\n        textAlign: 'center',\n        color: 'error.main'\n      },\n      children: /*#__PURE__*/_jsxDEV(Typography, {\n        children: [\"Error loading map: \", mapError]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(Box, {\n      ref: mapContainerRef,\n      className: \"map-container\",\n      sx: {\n        width: '100%',\n        height: '100%',\n        minHeight: '500px',\n        border: '1px solid #ddd'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 156,\n    columnNumber: 5\n  }, this);\n};\n_s(OpportunityMap, \"voky1BINEACWLo6I8ZzSqWpPHoE=\");\n_c = OpportunityMap;\nexport default OpportunityMap;\nvar _c;\n$RefreshReg$(_c, \"OpportunityMap\");","map":{"version":3,"names":["React","useRef","useEffect","useState","mapboxgl","Box","Typography","jsxDEV","_jsxDEV","accessToken","console","log","version","OpportunityMap","neighborhoods","_s","mapContainerRef","mapRef","mapError","setMapError","current","map","Map","container","style","center","zoom","attributionControl","addControl","NavigationControl","Marker","setLngLat","addTo","remove","error","message","isStyleLoaded","once","addNeighborhoodsToMap","data","getSource","removeLayer","removeSource","addSource","type","addLayer","id","source","layout","paint","popup","Popup","closeButton","closeOnClick","on","e","getCanvas","cursor","properties","features","coordinates","lngLat","html","name","opportunityScore","schoolQuality","description","setHTML","sx","width","height","position","children","p","textAlign","color","fileName","_jsxFileName","lineNumber","columnNumber","ref","className","minHeight","border","_c","$RefreshReg$"],"sources":["/Users/mahiarahman/Documents/Harvard/classes/cs1060/hw6/redesigning_opportunity/client/src/components/OpportunityMap.js"],"sourcesContent":["import React, { useRef, useEffect, useState } from 'react';\nimport mapboxgl from 'mapbox-gl';\nimport 'mapbox-gl/dist/mapbox-gl.css';\nimport { Box, Typography } from '@mui/material';\n\n// Set the Mapbox access token\nmapboxgl.accessToken = 'pk.eyJ1IjoibWFoaWFyIiwiYSI6ImNtNDY1YnlwdDB2Z2IybHEwd2w3MHJvb3cifQ.wJqnzFFTwLFwYhiPG3SWJA';\n\n// For debugging\nconsole.log('Mapbox token set:', mapboxgl.accessToken);\nconsole.log('Mapbox version:', mapboxgl.version);\n\nconst OpportunityMap = ({ neighborhoods }) => {\n  const mapContainerRef = useRef(null);\n  const mapRef = useRef(null);\n  const [mapError, setMapError] = useState(null);\n  \n  // Initialize map when component mounts\n  useEffect(() => {\n    console.log('Initializing map');\n    \n    // Check if map is already initialized\n    if (mapRef.current) return;\n    \n    try {\n      console.log('Creating map with container:', mapContainerRef.current);\n      \n      const map = new mapboxgl.Map({\n        container: mapContainerRef.current,\n        style: 'mapbox://styles/mapbox/streets-v12',\n        center: [-73.97, 40.75], // NYC coordinates\n        zoom: 10,\n        attributionControl: true\n      });\n      \n      console.log('Map initialized successfully');\n      mapRef.current = map;\n      \n      // Add navigation control\n      map.addControl(new mapboxgl.NavigationControl(), 'top-right');\n      \n      // Add a simple marker for testing\n      new mapboxgl.Marker()\n        .setLngLat([-73.97, 40.75])\n        .addTo(map);\n      \n      // Clean up on unmount\n      return () => map.remove();\n    } catch (error) {\n      console.error('Error initializing map:', error);\n      setMapError(`Failed to initialize map: ${error.message}`);\n    }\n  }, []);\n  \n  // Add neighborhoods data when it's available\n  useEffect(() => {\n    if (!mapRef.current || !neighborhoods) return;\n    \n    const map = mapRef.current;\n    \n    try {\n      // Wait for the map to be loaded\n      if (!map.isStyleLoaded()) {\n        map.once('style.load', () => {\n          addNeighborhoodsToMap(map, neighborhoods);\n        });\n      } else {\n        addNeighborhoodsToMap(map, neighborhoods);\n      }\n    } catch (error) {\n      console.error('Error adding neighborhoods:', error);\n      setMapError(`Failed to add neighborhoods: ${error.message}`);\n    }\n  }, [neighborhoods]);\n  \n  // Helper function to add neighborhoods to the map\n  const addNeighborhoodsToMap = (map, data) => {\n    console.log('Adding neighborhoods to map');\n    \n    // Remove existing source and layers if they exist\n    if (map.getSource('neighborhoods')) {\n      map.removeLayer('neighborhood-borders');\n      map.removeLayer('neighborhood-fills');\n      map.removeSource('neighborhoods');\n    }\n    \n    // Add the neighborhoods data as a source\n    map.addSource('neighborhoods', {\n      type: 'geojson',\n      data: data\n    });\n    \n    // Add a layer for the neighborhood polygons\n    map.addLayer({\n      id: 'neighborhood-fills',\n      type: 'fill',\n      source: 'neighborhoods',\n      layout: {},\n      paint: {\n        'fill-color': [\n          'interpolate',\n          ['linear'],\n          ['get', 'opportunityScore'],\n          0, '#f7fbff',\n          2, '#d0e1f2',\n          4, '#94c4df',\n          6, '#4a98c9',\n          8, '#1764ab',\n          10, '#08306b'\n        ],\n        'fill-opacity': 0.7\n      }\n    });\n    \n    // Add a layer for the neighborhood borders\n    map.addLayer({\n      id: 'neighborhood-borders',\n      type: 'line',\n      source: 'neighborhoods',\n      layout: {},\n      paint: {\n        'line-color': '#000',\n        'line-width': 1\n      }\n    });\n    \n    // Add a popup on hover\n    const popup = new mapboxgl.Popup({\n      closeButton: false,\n      closeOnClick: false\n    });\n    \n    map.on('mouseenter', 'neighborhood-fills', (e) => {\n      map.getCanvas().style.cursor = 'pointer';\n      \n      const properties = e.features[0].properties;\n      const coordinates = e.lngLat;\n      \n      const html = `\n        <strong>${properties.name}</strong><br/>\n        Opportunity Score: ${properties.opportunityScore}<br/>\n        School Quality: ${properties.schoolQuality}<br/>\n        ${properties.description}\n      `;\n      \n      popup.setLngLat(coordinates).setHTML(html).addTo(map);\n    });\n    \n    map.on('mouseleave', 'neighborhood-fills', () => {\n      map.getCanvas().style.cursor = '';\n      popup.remove();\n    });\n  };\n  \n  return (\n    <Box sx={{ width: '100%', height: '100%', position: 'relative' }}>\n      {mapError ? (\n        <Box sx={{ p: 3, textAlign: 'center', color: 'error.main' }}>\n          <Typography>Error loading map: {mapError}</Typography>\n        </Box>\n      ) : (\n        <Box \n          ref={mapContainerRef} \n          className=\"map-container\"\n          sx={{ \n            width: '100%', \n            height: '100%',\n            minHeight: '500px',\n            border: '1px solid #ddd'\n          }} \n        />\n      )}\n    </Box>\n  );\n};\n\nexport default OpportunityMap;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}