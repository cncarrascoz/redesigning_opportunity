<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Building Your Child's Future</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="css/chatWidget.css">
    <link rel="stylesheet" href="css/actionPlan.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://api.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="js/neighborhoodAnalysis.js" type="module"></script>
</head>
<body>
    <!-- Page 1: Title Page -->
    <section id="title-page" class="page">
        <div class="content">
            <h1>Building Your Child's Future</h1>
            <div class="intro-text">
                <p>A friendly guide to creating opportunities for your family!</p>
                <p>Discover the best places to live</p>
                <p>Search for the best schools</p>
                <p>Find local resources and community programs</p>
                <p>Let's take this journey together</p>
                <p>one step at a time</p>
            </div>
        </div>
    </section>

    <!-- Page 2: Parent & Child Information -->
    <section id="info-page" class="page">
        <div class="content">
            <h2>Family Information</h2>
            <form id="family-form">
                <div class="form-section">
                    <h3>Parent Information</h3>
                    <div class="form-group">
                        <label for="address">Address:</label>
                        <input type="text" 
                               id="address" 
                               name="address" 
                               required 
                               placeholder="Start typing your address..."
                               autocomplete="street-address">
                    </div>
                    <div class="form-group">
                        <label for="income">Income:</label>
                        <input type="number" 
                               id="income" 
                               name="income" 
                               required 
                               min="0" 
                               step="1000"
                               placeholder="Annual household income">
                    </div>
                    <div class="form-group">
                        <label for="origin">Country of Origin (Optional):</label>
                        <input type="text" 
                               id="origin" 
                               name="origin"
                               autocomplete="country-name"
                               placeholder="Your country of origin">
                    </div>
                </div>

                <div class="form-section">
                    <h3>Child Information</h3>
                    <div class="form-group">
                        <label for="child-name">Name:</label>
                        <input type="text" 
                               id="child-name" 
                               name="child-name" 
                               required
                               placeholder="Child's name">
                    </div>
                    <div class="form-group">
                        <label for="gender">Gender:</label>
                        <select id="gender" name="gender" required>
                            <option value="">Select gender</option>
                            <option value="male">Male</option>
                            <option value="female">Female</option>
                            <option value="other">Other</option>
                            <option value="prefer-not">Prefer not to say</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="age">Age:</label>
                        <input type="number" 
                               id="age" 
                               name="age" 
                               required 
                               min="0" 
                               max="18"
                               placeholder="Child's age (0-18)">
                    </div>
                    <div class="form-group">
                        <label for="ethnicity">Ethnicity:</label>
                        <select id="ethnicity" name="ethnicity" required>
                            <option value="">Select ethnicity</option>
                            <option value="asian">Asian</option>
                            <option value="black">Black</option>
                            <option value="hispanic">Hispanic</option>
                            <option value="white">White</option>
                            <option value="other">Other</option>
                            <option value="prefer-not">Prefer not to say</option>
                        </select>
                    </div>
                </div>
                <button type="submit">Continue</button>
            </form>
        </div>
    </section>

    <!-- Page 3: Results -->
    <section id="results-page" class="page">
        <div class="content">
            <h2>Your Community Insights</h2>
            <div class="form-section">
                <div class="form-group">
                    <label for="zipcode">Enter Zipcode:</label>
                    <input type="text" 
                           id="zipcode" 
                           name="zipcode" 
                           pattern="[0-9]{5}" 
                           maxlength="5" 
                           required
                           placeholder="Enter 5-digit zipcode">
                </div>

                <!-- Nearby Neighborhoods Section -->
                <div class="results-section" id="neighborhoods">
                    <h3><i class="fas fa-home"></i> Nearby Neighborhoods</h3>
                    <div class="neighborhood-list">
                        <p class="placeholder-text">Enter a zipcode to discover nearby neighborhoods.</p>
                    </div>
                </div>

                <!-- Schools Section -->
                <div class="results-section" id="schools">
                    <h3><i class="fas fa-school"></i> Schools in the Area</h3>
                    <div class="schools-list">
                        <p class="placeholder-text">Enter a zipcode to see local schools.</p>
                    </div>
                </div>

                <!-- Demographics Section -->
                <div class="results-section" id="demographics">
                    <h3><i class="fas fa-users"></i> Community Demographics</h3>
                    <div class="demographics-display">
                        <div class="demographics-primary">
                            <p class="primary-summary">Enter a zipcode to learn about the community.</p>
                        </div>
                        <div class="demographics-detailed">
                            <p class="detailed-summary">We'll show you a detailed breakdown of who lives in this area.</p>
                        </div>
                        <div class="demographics-context">
                            <p class="context-summary">Once you enter a zipcode, we'll help you understand what these demographics mean for your family.</p>
                        </div>
                    </div>
                </div>

                <!-- Opportunity Map Section -->
                <div class="results-section" id="opportunity-map-section">
                    <h3><i class="fas fa-map-marked-alt"></i> Opportunity Map</h3>
                    <div class="opportunity-map-container">
                        <div class="address-search">
                            <input type="text" id="map-address-input" placeholder="Enter your address to see opportunities">
                            <button id="map-address-search">Search</button>
                        </div>
                        <div class="map-container-wrapper">
                            <div id="opportunity-map" class="map-container"></div>
                            
                            <!-- Neighborhood Analysis Panel -->
                            <div class="neighborhood-analysis">
                                <div class="opportunity-score">
                                    <h4>Your Opportunity Score</h4>
                                    <div class="score-circle">
                                        <span class="score-value">9/10</span>
                                    </div>
                                    <p class="score-description">This score represents the economic mobility potential for children in this area.</p>
                                </div>
                                
                                <div class="neighborhood-factors">
                                    <h4>Neighborhood Factors</h4>
                                    <p class="factor-instruction">(Click to set your own rating)</p>
                                    
                                    <!-- School Quality Factor -->
                                    <div class="factor-item">
                                        <div class="factor-row">
                                            <span class="factor-name">School Quality</span>
                                            <span class="factor-score">7/10</span>
                                        </div>
                                        <div class="factor-icons">
                                            <i class="fas fa-graduation-cap factor-icon"></i>
                                            <i class="fas fa-graduation-cap factor-icon"></i>
                                            <i class="fas fa-graduation-cap factor-icon"></i>
                                            <i class="fas fa-graduation-cap factor-icon"></i>
                                            <i class="fas fa-graduation-cap factor-icon"></i>
                                            <i class="fas fa-graduation-cap factor-icon"></i>
                                            <i class="fas fa-graduation-cap factor-icon"></i>
                                            <i class="fas fa-graduation-cap factor-icon inactive"></i>
                                            <i class="fas fa-graduation-cap factor-icon inactive"></i>
                                            <i class="fas fa-graduation-cap factor-icon inactive"></i>
                                        </div>
                                    </div>
                                    
                                    <!-- Safety Factor -->
                                    <div class="factor-item">
                                        <div class="factor-row">
                                            <span class="factor-name">Safety</span>
                                            <span class="factor-score">8/10</span>
                                        </div>
                                        <div class="factor-icons">
                                            <i class="fas fa-shield-alt factor-icon"></i>
                                            <i class="fas fa-shield-alt factor-icon"></i>
                                            <i class="fas fa-shield-alt factor-icon"></i>
                                            <i class="fas fa-shield-alt factor-icon"></i>
                                            <i class="fas fa-shield-alt factor-icon"></i>
                                            <i class="fas fa-shield-alt factor-icon"></i>
                                            <i class="fas fa-shield-alt factor-icon"></i>
                                            <i class="fas fa-shield-alt factor-icon"></i>
                                            <i class="fas fa-shield-alt factor-icon inactive"></i>
                                            <i class="fas fa-shield-alt factor-icon inactive"></i>
                                        </div>
                                    </div>
                                    
                                    <!-- Healthcare Factor -->
                                    <div class="factor-item">
                                        <div class="factor-row">
                                            <span class="factor-name">Healthcare</span>
                                            <span class="factor-score">7/10</span>
                                        </div>
                                        <div class="factor-icons">
                                            <i class="fas fa-hospital factor-icon"></i>
                                            <i class="fas fa-hospital factor-icon"></i>
                                            <i class="fas fa-hospital factor-icon"></i>
                                            <i class="fas fa-hospital factor-icon"></i>
                                            <i class="fas fa-hospital factor-icon"></i>
                                            <i class="fas fa-hospital factor-icon"></i>
                                            <i class="fas fa-hospital factor-icon"></i>
                                            <i class="fas fa-hospital factor-icon inactive"></i>
                                            <i class="fas fa-hospital factor-icon inactive"></i>
                                            <i class="fas fa-hospital factor-icon inactive"></i>
                                        </div>
                                    </div>
                                    
                                    <!-- Amenities Factor -->
                                    <div class="factor-item">
                                        <div class="factor-row">
                                            <span class="factor-name">Amenities</span>
                                            <span class="factor-score">8/10</span>
                                        </div>
                                        <div class="factor-icons">
                                            <i class="fas fa-store factor-icon"></i>
                                            <i class="fas fa-store factor-icon"></i>
                                            <i class="fas fa-store factor-icon"></i>
                                            <i class="fas fa-store factor-icon"></i>
                                            <i class="fas fa-store factor-icon"></i>
                                            <i class="fas fa-store factor-icon"></i>
                                            <i class="fas fa-store factor-icon"></i>
                                            <i class="fas fa-store factor-icon"></i>
                                            <i class="fas fa-store factor-icon inactive"></i>
                                            <i class="fas fa-store factor-icon inactive"></i>
                                        </div>
                                    </div>
                                    
                                    <!-- Housing Factor -->
                                    <div class="factor-item">
                                        <div class="factor-row">
                                            <span class="factor-name">Housing</span>
                                            <span class="factor-score">6/10</span>
                                        </div>
                                        <div class="factor-icons">
                                            <i class="fas fa-home factor-icon"></i>
                                            <i class="fas fa-home factor-icon"></i>
                                            <i class="fas fa-home factor-icon"></i>
                                            <i class="fas fa-home factor-icon"></i>
                                            <i class="fas fa-home factor-icon"></i>
                                            <i class="fas fa-home factor-icon"></i>
                                            <i class="fas fa-home factor-icon inactive"></i>
                                            <i class="fas fa-home factor-icon inactive"></i>
                                            <i class="fas fa-home factor-icon inactive"></i>
                                            <i class="fas fa-home factor-icon inactive"></i>
                                        </div>
                                    </div>
                                    
                                    <!-- Transportation Factor -->
                                    <div class="factor-item">
                                        <div class="factor-row">
                                            <span class="factor-name">Transportation</span>
                                            <span class="factor-score">7/10</span>
                                        </div>
                                        <div class="factor-icons">
                                            <i class="fas fa-bus factor-icon"></i>
                                            <i class="fas fa-bus factor-icon"></i>
                                            <i class="fas fa-bus factor-icon"></i>
                                            <i class="fas fa-bus factor-icon"></i>
                                            <i class="fas fa-bus factor-icon"></i>
                                            <i class="fas fa-bus factor-icon"></i>
                                            <i class="fas fa-bus factor-icon"></i>
                                            <i class="fas fa-bus factor-icon inactive"></i>
                                            <i class="fas fa-bus factor-icon inactive"></i>
                                            <i class="fas fa-bus factor-icon inactive"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="map-legend">
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: #e53e3e;"></div>
                                <span class="legend-label">1</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: #dd6b20;"></div>
                                <span class="legend-label">2</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: #d69e2e;"></div>
                                <span class="legend-label">3</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: #b7791f;"></div>
                                <span class="legend-label">4</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: #975a16;"></div>
                                <span class="legend-label">5</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: #68d391;"></div>
                                <span class="legend-label">6</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: #48bb78;"></div>
                                <span class="legend-label">7</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: #38a169;"></div>
                                <span class="legend-label">8</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: #2f855a;"></div>
                                <span class="legend-label">9</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: #276749;"></div>
                                <span class="legend-label">10</span>
                            </div>
                            <span class="legend-text">Opportunity Score (1-10)</span>
                        </div>
                    </div>
                </div>

                <!-- Housing Resources Section -->
                <div class="results-section" id="housing">
                    <h3><i class="fas fa-building"></i> Housing Resources</h3>
                    <div class="housing-links">
                        <p class="placeholder-text">Enter a zipcode to find housing resources.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Page 4: Action Plan -->
    <section id="action-plan-page" class="page">
        <div class="content">
            <div class="action-plan">
                <div class="action-plan-header">
                    <h2 class="action-plan-title">Your Action Plan</h2>
                    <span class="action-plan-focus">Focus: Education</span>
                </div>

                <div class="progress-bar">
                    <div class="progress-fill" style="width: 33%"></div>
                </div>

                <ul class="action-steps">
                    <!-- Step 1 -->
                    <li class="action-step completed">
                        <div class="action-step-header">
                            <span class="step-number">1</span>
                            <h3 class="step-title">Research Local Schools</h3>
                        </div>
                        <p class="step-description">
                            Look up school ratings, performance metrics, and student demographics for schools in your area.
                        </p>
                        <div class="step-actions">
                            <button class="step-button">
                                <i class="fas fa-check"></i>
                                Completed
                            </button>
                            <button class="step-button">
                                <i class="fas fa-edit"></i>
                                Edit
                            </button>
                        </div>
                    </li>

                    <!-- Step 2 -->
                    <li class="action-step">
                        <div class="action-step-header">
                            <span class="step-number">2</span>
                            <h3 class="step-title">Schedule School Visits</h3>
                        </div>
                        <p class="step-description">
                            Contact your top 3 school choices to arrange tours and meetings with administrators.
                        </p>
                        <div class="step-actions">
                            <button class="step-button">
                                <i class="far fa-square"></i>
                                Mark Complete
                            </button>
                            <button class="step-button">
                                <i class="fas fa-edit"></i>
                                Edit
                            </button>
                        </div>
                    </li>

                    <!-- Step 3 -->
                    <li class="action-step">
                        <div class="action-step-header">
                            <span class="step-number">3</span>
                            <h3 class="step-title">Review Educational Programs</h3>
                        </div>
                        <p class="step-description">
                            Compare special programs, extracurricular activities, and support services offered by each school.
                        </p>
                        <div class="step-actions">
                            <button class="step-button">
                                <i class="far fa-square"></i>
                                Mark Complete
                            </button>
                            <button class="step-button">
                                <i class="fas fa-edit"></i>
                                Edit
                            </button>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </section>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="config.js"></script>
    <script src="services.js"></script>
    <script src="script.js" type="module"></script>
    <script type="module">
        import ChatWidget from './js/chatWidget.js';
        import ActionPlan from './js/actionPlan.js';
        
        const chatWidget = new ChatWidget();
        const actionPlan = new ActionPlan();
        
        chatWidget.init();
    </script>
    
    <!-- Direct map initialization -->
    <script>
        let directMap = null;
        let markers = [];
        
        // Function to search for an address
        async function searchAddress() {
            const addressInput = document.getElementById('map-address-input');
            const address = addressInput.value.trim();
            
            if (!address) {
                alert('Please enter an address to search.');
                return;
            }
            
            try {
                // Show loading state
                document.getElementById('opportunity-map-section').classList.add('loading');
                
                // Use Mapbox Geocoding API
                const response = await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(address)}.json?access_token=${mapboxgl.accessToken}&country=us&limit=1`);
                const data = await response.json();
                
                if (data.features && data.features.length > 0) {
                    const feature = data.features[0];
                    const [lng, lat] = feature.center;
                    
                    // Fly to the location
                    directMap.flyTo({
                        center: [lng, lat],
                        zoom: 12,
                        essential: true
                    });
                    
                    // Extract zipcode if available
                    let zipcode = '';
                    if (feature.context) {
                        const postcodeObj = feature.context.find(c => c.id.startsWith('postcode'));
                        if (postcodeObj) {
                            zipcode = postcodeObj.text;
                        }
                    }
                    
                    // Update the zipcode input field if we found a zipcode
                    if (zipcode) {
                        document.getElementById('zipcode').value = zipcode;
                    }
                    
                    try {
                        // Check if dataService is available
                        if (!window.dataService || typeof window.dataService.getNeighborhoods !== 'function') {
                            console.error('dataService is not available or missing getNeighborhoods method');
                            const mapLegend = document.querySelector('.map-legend');
                            mapLegend.innerHTML = `
                                <div class="map-legend-content">
                                    <p>Location found: <strong>${feature.place_name}</strong></p>
                                    <p>Map data service is not available. Please refresh the page and try again.</p>
                                </div>
                            `;
                            return;
                        }
                        
                        // Get neighborhood data - only if we have a zipcode
                        if (zipcode) {
                            const neighborhoods = await dataService.getNeighborhoods(zipcode);
                            
                            // Clear existing markers
                            markers.forEach(marker => marker.remove());
                            markers = [];
                            
                            // Add markers for neighborhoods
                            neighborhoods.forEach((neighborhood, index) => {
                                // Generate some coordinates around the center point
                                const markerLat = lat + (Math.random() - 0.5) * 0.05;
                                const markerLng = lng + (Math.random() - 0.5) * 0.05;
                                
                                // Create marker element
                                const el = document.createElement('div');
                                el.className = 'neighborhood-marker';
                                el.innerHTML = '<i class="fas fa-map-marker-alt"></i>';
                                
                                // Create and add marker
                                const marker = new mapboxgl.Marker(el)
                                    .setLngLat([markerLng, markerLat])
                                    .addTo(directMap);
                                
                                // Add popup
                                marker.getElement().addEventListener('click', () => {
                                    const popup = new mapboxgl.Popup({ closeButton: true })
                                        .setLngLat([markerLng, markerLat])
                                        .setHTML(`
                                            <h4>${neighborhood.name}</h4>
                                            <p><strong>Distance:</strong> ${neighborhood.distance}</p>
                                            <p>${neighborhood.description}</p>
                                        `)
                                        .addTo(directMap);
                                });
                                
                                markers.push(marker);
                            });
                            
                            // Update map legend
                            const mapLegend = document.querySelector('.map-legend');
                            mapLegend.innerHTML = `
                                <div class="map-legend-content">
                                    <p><strong>${neighborhoods.length} neighborhoods</strong> found near ${zipcode}.</p>
                                    <p>Click on markers to see details about each neighborhood.</p>
                                </div>
                            `;
                        } else {
                            // Just update the legend if no zipcode
                            const mapLegend = document.querySelector('.map-legend');
                            mapLegend.innerHTML = `
                                <div class="map-legend-content">
                                    <p>Location found: <strong>${feature.place_name}</strong></p>
                                    <p>No zipcode information available for this location.</p>
                                </div>
                            `;
                        }
                    } catch (neighborhoodError) {
                        console.error('Error getting neighborhood data:', neighborhoodError);
                        // Don't show an alert, just update the legend
                        const mapLegend = document.querySelector('.map-legend');
                        mapLegend.innerHTML = `
                            <div class="map-legend-content">
                                <p>Location found: <strong>${feature.place_name}</strong></p>
                                <p>Could not retrieve neighborhood data for this location.</p>
                            </div>
                        `;
                    }
                } else {
                    // Just show a message in the legend instead of an alert
                    const mapLegend = document.querySelector('.map-legend');
                    mapLegend.innerHTML = `
                        <div class="map-legend-content">
                            <p>No results found for address: <strong>${address}</strong></p>
                            <p>Please try another address.</p>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Error searching address:', error);
                // Update the legend instead of showing an alert
                const mapLegend = document.querySelector('.map-legend');
                mapLegend.innerHTML = `
                    <div class="map-legend-content">
                        <p>Error searching for address: <strong>${address}</strong></p>
                        <p>Please check your internet connection and try again.</p>
                    </div>
                `;
            } finally {
                // Remove loading state
                document.getElementById('opportunity-map-section').classList.remove('loading');
            }
        }
        
        // Create a mock dataService if it's not available
if (!window.dataService) {
    console.log('Creating mock dataService for map');
    window.dataService = {
        getNeighborhoods: async function(zipcode) {
            console.log('Using mock neighborhood data for zipcode:', zipcode);
            // Return mock neighborhood data
            return [
                {
                    name: 'Downtown',
                    distance: '0.5 miles',
                    description: 'Vibrant downtown area with shops, restaurants, and entertainment options.'
                },
                {
                    name: 'Riverside',
                    distance: '1.2 miles',
                    description: 'Beautiful neighborhood near the river with parks and recreational areas.'
                },
                {
                    name: 'Oak Hills',
                    distance: '2.3 miles',
                    description: 'Family-friendly neighborhood with good schools and community centers.'
                }
            ];
        }
    };
}

document.addEventListener('DOMContentLoaded', function() {
            // Initialize the map directly
            try {
                const mapContainer = document.getElementById('opportunity-map');
                if (mapContainer) {
                    console.log('Initializing map directly');
                    mapboxgl.accessToken = 'pk.eyJ1IjoibWFoaWFyIiwiYSI6ImNtNDY1YnlwdDB2Z2IybHEwd2w3MHJvb3cifQ.wJqnzFFTwLFwYhiPG3SWJA';
                    
                    directMap = new mapboxgl.Map({
                        container: 'opportunity-map',
                        style: 'mapbox://styles/mapbox/streets-v11',
                        center: [-95.7129, 37.0902],
                        zoom: 3
                    });
                    
                    directMap.addControl(new mapboxgl.NavigationControl());
                    
                    console.log('Map initialized directly:', directMap);
                    
                    // Import and initialize neighborhood analysis panel
                    import('./js/neighborhoodAnalysis.js').then(module => {
                        const NeighborhoodAnalysis = module.default;
                        const neighborhoodPanel = new NeighborhoodAnalysis('.neighborhood-analysis');
                        
                        // Store the panel instance globally for access in event handlers
                        window.neighborhoodPanel = neighborhoodPanel;
                    }).catch(error => {
                        console.error('Error loading neighborhood analysis module:', error);
                    });
                    
                    // Add event listener for search button
                    const searchButton = document.getElementById('map-address-search');
                    if (searchButton) {
                        searchButton.addEventListener('click', async function() {
                            await searchAddress();
                            
                            // Make sure the neighborhood panel is initialized
                            if (window.neighborhoodPanel) {
                                // Update neighborhood analysis panel with mock data for now
                                // In a real implementation, this would come from the API
                                const mockData = {
                                    opportunityScore: 9,
                                    factors: {
                                        schoolQuality: 7,
                                        safety: 8,
                                        healthcare: 7,
                                        amenities: 8,
                                        housing: 6,
                                        transportation: 7
                                    }
                                };
                                
                                window.neighborhoodPanel.updateAnalysis(mockData);
                                
                                // Add job opportunities based on the memories
                                // Using the exact structure from the JobOpportunity type mentioned in the memories
                                const jobOpportunities = [
                                    {
                                        sector: 'Technology',
                                        growthRate: 14.5,
                                        medianSalary: 95000,
                                        description: 'Strong demand for software developers and IT specialists.',
                                        resources: [{
                                            name: 'Tech Career Hub',
                                            url: 'https://techcareerhub.com',
                                            description: 'Resources for tech job seekers'
                                        }]
                                    },
                                    {
                                        sector: 'Healthcare',
                                        growthRate: 12.8,
                                        medianSalary: 78000,
                                        description: 'Growing need for healthcare professionals at all levels.',
                                        resources: [{
                                            name: 'Healthcare Jobs',
                                            url: 'https://healthcarejobs.org',
                                            description: 'Healthcare career opportunities'
                                        }]
                                    },
                                    {
                                        sector: 'Education',
                                        growthRate: 8.2,
                                        medianSalary: 65000,
                                        description: 'Steady demand for teachers and educational support staff.',
                                        resources: [{
                                            name: 'Education Jobs',
                                            url: 'https://educationjobs.org',
                                            description: 'Teaching and education positions'
                                        }]
                                    }
                                ];
                                
                                window.neighborhoodPanel.addJobOpportunities(jobOpportunities);
                                
                                // Generate personalized job opportunity advice based on income
                                // This follows the generateJobOpportunityAdvice function mentioned in memories
                                const income = document.getElementById('income')?.value || 75000;
                                const hasChildren = document.getElementById('child-name')?.value ? true : false;
                                const advice = window.neighborhoodPanel.generateJobOpportunityAdvice(income, hasChildren);
                                console.log('Job opportunity advice:', advice);
                            } else {
                                console.error('Neighborhood panel not initialized yet');
                            }
                        });
                    }
                } else {
                    console.error('Map container not found');
                }
            } catch (error) {
                console.error('Error initializing map directly:', error);
            }
        });
    </script>
</body>
</html>
